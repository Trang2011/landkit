1
SELECT TENCONGTY FROM nhacungcap;
2
SELECT MAHANG,TENHANG,SOLUONG FROM mathang;
3
SELECT concat(HO," ",TEN) AS HOTEN,DIACHI,YEAR(NGAYLAMVIEC) AS NAMLAMVIEC FROM nhanvien;
4
SELECT DIACHI, DIENTHOAI FROM nhacungcap WHERE TENGIAODICH = 'VINAMILK';
5
SELECT MAHANG,TENHANG FROM mathang WHERE GIAHANG > 100000 AND SOLUONG < 50;
6
SELECT TENHANG,TENCONGTY FROM mathang INNER JOIN nhacungcap ON mathang.nhacungcap_MACONGTY = nhacungcap.MACONGTY;
7
SELECT TENHANG FROM mathang INNER JOIN nhacungcap ON mathang.nhacungcap_MACONGTY = nhacungcap.MACONGTY WHERE TENGIAODICH = 'VIETTIEN';
8
SELECT DISTINCT TENCONGTY,DIACHI FROM mathang INNER JOIN loaihang ON mathang.loaihang_MALOAIHANG = loaihang.MALOAIHANG INNER JOIN nhacungcap ON nhacungcap.MACONGTY = mathang.nhacungcap_MACONGTY WHERE loaihang.MALOAIHANG = 'TP';
9
SELECT TENGIAODICH FROM khachhang INNER JOIN dondathang ON khachhang.MAKHACHHANG = dondathang.khachhang_MAKHACHHANG INNER JOIN chitietdathang ON dondathang.SOHOADON = chitietdathang.dondathang_SOHOADON INNER JOIN mathang ON chitietdathang.mathang_MAHANG = mathang.MAHANG WHERE mathang.TENHANG = 'SUA HOP';
10
SELECT TENGIAODICH,concat(HO," ",TEN) AS HOTENNHANVIEN,NGAYGIAOHANG,NOIGIAOHANG FROM khachhang INNER JOIN dondathang ON khachhang.MAKHACHHANG = dondathang.khachhang_MAKHACHHANG INNER JOIN nhanvien ON dondathang.nhanvien_MANHANVIEN = nhanvien.MANHANVIEN WHERE SOHOADON = 1;
11
SELECT concat(HO," ",TEN) AS HOTEN,(LUONGCOBAN + LUONGPHUCAP) AS LUONG FROM nhanvien;
12
SELECT TENHANG,(chitietdathang.SOLUONG * GIABAN - MUCGIAMGIA) AS SOTIEN FROM chitietdathang INNER JOIN mathang ON chitietdathang.mathang_MAHANG = mathang.MAHANG WHERE dondathang_SOHOADON = 3;
13
SELECT khachhang.TENGIAODICH FROM khachhang INNER JOIN nhacungcap ON khachhang.TENGIAODICH = nhacungcap.TENGIAODICH;
14
SELECT DISTNCT a.MANHANVIEN,concat(a.HO," ",a.TEN) AS HOTEN,a.NGAYSINH FROM nhanvien AS a INNER JOIN nhanvien AS b ON a.NGAYSINH = b.NGAYSINH AND a.MANHANVIEN <> b.MANHANVIEN;
15
SELECT SOHOADON,TENCONGTY FROM khachhang INNER JOIN dondathang ON khachhang.MAKHACHHANG = dondathang.khachhang_MAKHACHHANG WHERE NOIGIAOHANG = khachhang.DIACHI;
16
SELECT TENCONGTY,TENGIAODICH,DIACHI,DIENTHOAI FROM khachhang UNION SELECT TENCONGTY,TENGIAODICH,DIACHI,DIENTHOAI FROM nhacungcap;
17
SELECT MAHANG,TENHANG FROM mathang WHERE MAHANG NOT IN (SELECT mathang_MAHANG FROM chitietdathang);
18
SELECT MANHANVIEN,concat(HO," ",TEN) AS HOTEN FROM nhanvien WHERE MANHANVIEN NOT IN (SELECT nhanvien_MANHANVIEN FROM dondathang);
19
SELECT MANHANVIEN,concat(HO," ",TEN) AS HOTEN,LUONGCOBAN FROM nhanvien WHERE LUONGCOBAN = (SELECT MAX(LUONGCOBAN) FROM nhanvien);
20
SELECT dondathang.SOHOADON, SUM(chitietdathang.SOLUONG*GIABAN) AS TONGTIEN FROM dondathang INNER JOIN chitietdathang ON dondathang.SOHOADON = chitietdathang.dondathang_SOHOADON GROUP BY dondathang.SOHOADON;
21
SELECT mathang_MAHANG,COUNT(mathang_MAHANG) FROM chitietdathang INNER JOIN dondathang ON dondathang.SOHOADON = chitietdathang.dondathang_SOHOADON WHERE YEAR(NGAYDATHANG) = 2006 GROUP BY mathang_MAHANG HAVING COUNT(mathang_MAHANG) = 1;
22
SELECT MAKHACHHANG,SUM(chitietdathang.SOLUONG*GIABAN) AS TONGTIEN FROM dondathang INNER JOIN chitietdathang ON dondathang.SOHOADON = chitietdathang.dondathang_SOHOADON INNER JOIN khachhang ON khachhang.MAKHACHHANG = dondathang.khachhang_MAKHACHHANG GROUP BY MAKHACHHANG;
23
SELECT MANHANVIEN,concat(HO," ",TEN) AS HOTEN,COUNT(SOHOADON) AS TONGHOADON FROM nhanvien LEFT JOIN dondathang ON nhanvien.MANHANVIEN = dondathang.nhanvien_MANHANVIEN GROUP BY MANHANVIEN;
24
SELECT MONTH(NGAYDATHANG) AS THANG,SUM(chitietdathang.SOLUONG * GIABAN) AS TONGTIENTHU FROM dondathang INNER JOIN chitietdathang ON dondathang.SOHOADON = chitietdathang.dondathang_SOHOADON WHERE YEAR(NGAYDATHANG) = 2006 GROUP BY MONTH(NGAYDATHANG);
25
SELECT MAHANG,TENHANG,SUM(chitietdathang.SOLUONG*GIABAN - chitietdathang.SOLUONG*GIAHANG) AS TIENLOI FROM mathang INNER JOIN chitietdathang ON mathang.MAHANG = chitietdathang.mathang_MAHANG GROUP BY MAHANG, TENHANG; 
26
SELECT MAHANG,TENHANG,SUM(mathang.SOLUONG)-SUM(chitietdathang.SOLUONG) AS SOLUONGCONLAI FROM mathang LEFT JOIN chitietdathang ON mathang.MAHANG = chitietdathang.mathang_MAHANG GROUP BY MAHANG, TENHANG;
27
SELECT MANHANVIEN,concat(HO," ",TEN) AS HOTEN,sum(soluong) AS SOLUONGHANG FROM nhanvien INNER JOIN dondathang ON nhanvien.MANHANVIEN = dondathang.nhanvien_MANHANVIEN INNER JOIN chitietdathang ON dondathang.SOHOADON = chitietdathang.dondathang_SOHOADON GROUP BY MANHANVIEN HAVING SOLUONGHANG = (SELECT SUM(SOLUONG) FROM nhanvien INNER JOIN dondathang ON nhanvien.MANHANVIEN = dondathang.nhanvien_MANHANVIEN INNER JOIN chitietdathang ON dondathang.SOHOADON = chitietdathang.dondathang_SOHOADON GROUP BY MANHANVIEN ORDER BY SUM(SOLUONG) DESC LIMIT 1);
28
SELECT SOHOADON,SUM(SOLUONG) AS SOLUONGHANG FROM dondathang INNER JOIN chitietdathang ON dondathang.SOHOADON = chitietdathang.dondathang_SOHOADON GROUP BY SOHOADON HAVING SOLUONGHANG = (SELECT SUM(SOLUONG) FROM dondathang INNER JOIN chitietdathang ON dondathang.SOHOADON = chitietdathang.dondathang_SOHOADON GROUP BY SOHOADON ORDER BY SUM(SOLUONG) LIMIT 1);
29
SELECT SUM(SOLUONG*GIABAN) AS TONGTIEN FROM chitietdathang INNER JOIN dondathang ON dondathang.SOHOADON = chitietdathang.dondathang_SOHOADON GROUP BY SOHOADON ORDER BY TONGTIEN DESC LIMIT 1;
30
SELECT dondathang.SOHOADON,chitietdathang.mathang_MAHANG,(chitietdathang.SOLUONG*GIABAN) FROM dondathang INNER JOIN chitietdathang ON dondathang.SOHOADON = chitietdathang.dondathang_SOHOADON INNER JOIN mathang ON chitietdathang.mathang_MAHANG = mathang.MAHANG ORDER BY dondathang.SOHOADON DESC COMPUTE SUM(chitietdathang.SOLUONG*GIABAN) by dondathang.SOHOADON;
31
SELECT loaihang.MALOAIHANG,TENLOAIHANG,MAHANG,TENHANG,SOLUONG FROM loaihoang INNER JOIN mathang ON loaihang.MALOAIHANG = mathang.MALOAIHANG ORDER BY loaihang.MALOAIHANG COMPUTE SUM(SOLUONG) BY loaihang.MALOAIHANG COMPUTE SUM(SOLUONG);
32
SELECT mathang_MAHANG,TENHANG, 
SUM(CASE MONTH(NGAYDATHANG) WHEN 1 THEN chitietdathang.SOLUONG ELSE 0 END) as Jan,
SUM(CASE MONTH(NGAYDATHANG) WHEN 2 THEN chitietdathang.SOLUONG ELSE 0 END) as Feb,
SUM(CASE MONTH(NGAYDATHANG) WHEN 3 THEN chitietdathang.SOLUONG ELSE 0 END) as Mar,
SUM(CASE MONTH(NGAYDATHANG) WHEN 4 THEN chitietdathang.SOLUONG ELSE 0 END) as Apr,
SUM(CASE MONTH(NGAYDATHANG) WHEN 5 THEN chitietdathang.SOLUONG ELSE 0 END) as May,
SUM(CASE MONTH(NGAYDATHANG) WHEN 6 THEN chitietdathang.SOLUONG ELSE 0 END) as Jun,
SUM(CASE MONTH(NGAYDATHANG) WHEN 7 THEN chitietdathang.SOLUONG ELSE 0 END) as Jul,
SUM(CASE MONTH(NGAYDATHANG) WHEN 8 THEN chitietdathang.SOLUONG ELSE 0 END) as Aug,
SUM(CASE MONTH(NGAYDATHANG) WHEN 9 THEN chitietdathang.SOLUONG ELSE 0 END) as Sep,
SUM(CASE MONTH(NGAYDATHANG) WHEN 10 THEN chitietdathang.SOLUONG ELSE 0 END) as Oct,
SUM(CASE MONTH(NGAYDATHANG) WHEN 11 THEN chitietdathang.SOLUONG ELSE 0 END) as Nov,
SUM(CASE MONTH(NGAYDATHANG) WHEN 12 THEN chitietdathang.SOLUONG ELSE 0 END) as Dec,
SUM(chitietdathang.SOLUONG) as WHOLEYEAR
FROM dondathang INNER JOIN chitietdathang ON dondathang.SOHOADON = chitietdathang.dondathang_SOHOADON INNER JOIN mathang on chiitetdathang.mathang_MAHANG = mathang.MAHANG WHERE YEAR(NGAYDATHANG) = 2006 GROUP BY mathang_MAHANG,TENHANG;
33
UPDATE dondathang SET NGAYCHUYENHANG = NGAYDATHANG WHERE NGAYCHUYENHANG is NULL;
34
UPDATE mathang INNER JOIN nhacungcap ON mathang.nhacungcap_macongty = nhacungcap.macongty set SOLUONG = SOLUONG * 2 WHERE TENGIAODICH = 'VINAMILK';
35
UPDATE dondathang INNER JOIN khachhang ON dondathang.khachhang_MAKHACHHANG = khachhang.MAKHACHHANG SET NOIGIAOHANG = DIACHI WHERE NOIGIAOHANG is NULL;
36
UPDATE khachhang INNER JOIN nhacungcap ON khachhang.TENCONGTY = nhacungcap.TENCONGTY AND khachhang.TENGIAODICH = nhacungcap.TENGIAODICH SET khachhang.DIACHI = nhacungcap.DIACHI, khachhang.DIENTHOAI = nhacungcap.DIENTHOAI, khachhang.FAX = nhacungcap.FAX, khachhang.EMAIL = nhacungcap.EMAIL;
37
UPDATE nhanvien SET LUONGCOBAN = 1.5*LUONGCOBAN WHERE MANHANVIEN IN (SELECT MANHANVIEN FROM (SELECT MANHANVIEN FROM nhanvien INNER JOIN dondathang ON nhanvien.MANHANVIEN = dondathang.nhanvien_MANHANVIEN INNER JOIN chitietdathang ON dondathang.SOHOADON = chitietdathang.dondathang_SOHOADON WHERE YEAR(NGAYDATHANG) = 2003 GROUP BY MANHANVIEN HAVING SUM(SOLUONG) > 100) AS temp);
38
UPDATE nhanvien SET LUONGPHUCAP = 0.5*LUONGCOBAN WHERE MANHANVIEN IN (SELECT MANHANVIEN FROM (SELECT MANHANVIEN FROM nhanvien INNER JOIN dondathang ON nhanvien.MANHANVIEN = dondathang.nhanvien_MANHANVIEN INNER JOIN chitietdathang ON dondathang.SOHOADON = chitietdathang.dondathang_SOHOADON GROUP BY MANHANVIEN HAVING SUM(SOLUONG) = (SELECT SUM(SOLUONG) FROM nhanvien INNER JOIN dondathang ON nhanvien.MANHANVIEN = dondathang.nhanvien_MANHANVIEN INNER JOIN chitietdathang ON dondathang.SOHOADON = chitietdathang.dondathang_SOHOADON GROUP BY MANHANVIEN ORDER BY SUM(SOLUONG) DESC LIMIT 1)) AS temp);
39
UPDATE nhanvien SET LUONGCOBAN = 0.75*LUONGCOBAN WHERE MANHANVIEN NOT IN (SELECT MANHANVIEN FROM (SELECT MANHANVIEN FROM nhanvien INNER JOIN dondathang ON nhanvien.MANHANVIEN = dondathang.nhanvien_MANHANVIEN WHERE YEAR(NGAYDATHANG) = 2003) AS temp);
40
UPDATE dondathang SET SOTIEN = (SELECT SUM(SOLUONG*GIABAN) FROM chitietdathang WHERE SOHOADON = dondathang_SOHOADON GROUP BY SOHOADON);
41
DELETE FROM nhanvien WHERE YEAR(CURDATE()) - YEAR(NGAYLAMVIEC) > 40;
42
DELETE FROM dondathang WHERE YEAR(NGAYDATHANG) < 2000;
43
DELETE FROM loaihang WHERE MALOAIHANG NOT IN (SELECT loaihang_MALOAIHANG FROM mathang);
44
DELETE FROM khachhang WHERE MAKHACHHANG NOT IN (SELECT khachhang_MAKHACHHANG FROM dondathang);
45
DELETE FROM mathang WHERE soluong = 0 AND MAHANG NOT IN (SELECT mathang_MAHANG from chitietdathang);






 
